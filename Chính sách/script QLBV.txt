--DROP TABLE HSBA CASCADE CONSTRAINTS;
--DROP TABLE HSBA_DV CASCADE CONSTRAINTS;
--DROP TABLE BENHNHAN CASCADE CONSTRAINTS;
--DROP TABLE CSYT CASCADE CONSTRAINTS;
--DROP TABLE NHANVIEN CASCADE CONSTRAINTS;

CREATE TABLE HSBA
(
    MAHSBA CHAR(10),
    MABN CHAR(10),
    NGAY DATE,
    CHANDOAN NVARCHAR2(250),
    MABS CHAR(10),
    MAKHOA CHAR(10),
    MACSYT CHAR(10),
    KETLUAN NVARCHAR2(250),
    CONSTRAINT PK_HSBA PRIMARY KEY (MAHSBA) 
);

CREATE TABLE HSBA_DV
(
    MAHSBA CHAR(10),
    MADV CHAR(10),
    NGAY DATE,
    MAKTV CHAR(10),
    KETQUA NVARCHAR2(250),
    CONSTRAINT PK_HSBADV PRIMARY KEY (MAHSBA, MADV, NGAY) 
);

CREATE TABLE BENHNHAN
(
    MABN CHAR(10),
	MACSYT CHAR(10),
    TENBN NVARCHAR2(150), 
    CMND VARCHAR2(15),
    NGAYSINH DATE,
    SONHA VARCHAR2(10),
    TENDUONG NVARCHAR2(50),
    QUANHUYEN NVARCHAR2(50),
    TINHTP NVARCHAR2(50),
    TIENSUBENH NVARCHAR2(250),
    TIENSUBENHGD NVARCHAR2(250),
    DIUNGTHUOC NVARCHAR2(250),
    CONSTRAINT PK_BENHNHAN PRIMARY KEY (MABN) 
);

CREATE TABLE CSYT
(
    MACSYT CHAR(10),
    TENCSYT NVARCHAR2(150), 
    DCCSYT NVARCHAR2(250),
    SDTCSYT NVARCHAR2(12),
    CONSTRAINT PK_CSYT PRIMARY KEY (MACSYT) 
);

CREATE TABLE NHANVIEN
(
    MANV CHAR(10),
    HOTEN NVARCHAR2(150), 
    PHAI NVARCHAR2(4),
    NGAYSINH DATE,
    CMND VARCHAR2(15),
    QUEQUAN NVARCHAR2(250),
    SODT VARCHAR2(12),
    CSYT CHAR(6),
    VAITRO NVARCHAR2(100),
    CHUYENKHOA NVARCHAR2(100),
    CONSTRAINT PK_NHANVIEN PRIMARY KEY (MANV) 
);


ALTER TABLE HSBA ADD
    CONSTRAINT FK_HSBA_BENHNHAN FOREIGN KEY(MABN) REFERENCES BENHNHAN(MABN);
ALTER TABLE HSBA ADD
    CONSTRAINT FK_HSBA_NHANVIEN FOREIGN KEY(MABS) REFERENCES NHANVIEN(MANV);
ALTER TABLE HSBA ADD
    CONSTRAINT FK_HSBA_CSYT FOREIGN KEY(MACSYT) REFERENCES CSYT(MACSYT);

ALTER TABLE HSBA_DV ADD
    CONSTRAINT FK_HSBADV_HSBA FOREIGN KEY(MAHSBA) REFERENCES HSBA(MAHSBA);
ALTER TABLE HSBA_DV ADD
    CONSTRAINT FK_HSBADV_NHANVIEN FOREIGN KEY(MAKTV) REFERENCES NHANVIEN(MANV);
    
ALTER TABLE BENHNHAN ADD
    CONSTRAINT FK_BENHNHAN_CSYT FOREIGN KEY(MACSYT) REFERENCES CSYT(MACSYT);
    
ALTER TABLE NHANVIEN ADD
    CONSTRAINT FK_NHANVIEN_CSYT FOREIGN KEY(CSYT) REFERENCES CSYT(MACSYT);
    
CREATE ROLE ROLE_BENHNHAN NOT IDENTIFIED;
SET ROLE ROLE_BENHNHAN;
GRANT CREATE SESSION TO ROLE_BENHNHAN;

-- Tao ROLE NHANVIEN
CREATE ROLE NHANVIEN NOT IDENTIFIED;
SET ROLE NHANVIEN;
GRANT CREATE SESSION TO NHANVIEN;

-- Tao ROLE YBACSI
CREATE ROLE Y_BACSI;
SET ROLE Y_BACSI;
GRANT CREATE SESSION TO Y_BACSI;

-- T?o THANHTRA
CREATE ROLE THANHTRA;
SET ROLE THANHTRA;
GRANT CREATE SESSION TO THANHTRA;

--T?o ROLE QUANLY
CREATE ROLE CSYT;
SET ROLE CSYT;
GRANT CREATE SESSION TO CSYT;

--T?o ROLE_NGHIENCUU
CREATE ROLE NGHIENCUU;
SET ROLE NGHIENCUU;
GRANT CREATE SESSION TO NGHIENCUU;

